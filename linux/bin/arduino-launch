#!/bin/sh -x
	
# Retrieve handle and command
HANDLE=$1
COMMAND=$2

shift 2

# files to hold stdout and stderr output generated by running command
TMP_OUT=`mktemp`
TMP_ERR=`mktemp`

COMPLETE_COMMAND="$COMMAND $*"
($COMPLETE_COMMAND) 1>$TMP_OUT 2>$TMP_ERR

EXIT_CODE=$?

MESSAGE_FILE=`date +%s`
MESSAGE_FILE="$MESSAGE_FILE-$COMMAND-$HANDLE"

mv $TMP_OUT $MESSAGE_FILE.out
mv $TMP_ERR $MESSAGE_FILE.err

rm -f $TMP_OUT $TMP_ERR

